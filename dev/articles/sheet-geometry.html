<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="readxl">
<title>Sheet Geometry • readxl</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Source%20Sans%20Pro-0.4.0/font.css" rel="stylesheet">
<link href="../deps/_Source%20Code%20Pro-0.4.0/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sheet Geometry">
<meta property="og:description" content="readxl">
<meta property="og:image" content="https://readxl.tidyverse.org/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="readxl.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">readxl</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/column-names.html">Column Names</a>
    <a class="dropdown-item" href="../articles/multiple-header-rows.html">Multiple Header Rows</a>
    <a class="dropdown-item" href="../articles/readxl-workflows.html">readxl Workflows</a>
    <a class="dropdown-item" href="../articles/cell-and-column-types.html">Cell and Column Types</a>
    <a class="dropdown-item" href="../articles/sheet-geometry.html">Sheet Geometry</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/12/readxl-1-2-0/">Version 1.2.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/04/readxl-1-1-0/">Version 1.1.0</a>
    <a class="external-link dropdown-item" href="https://www.rstudio.com/blog/readxl-1-0-0/">Version 1.0.0</a>
    <a class="external-link dropdown-item" href="https://www.rstudio.com/blog/readxl-0-1-0/">Version 0.1.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tidyverse/readxl/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sheet Geometry</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/readxl/blob/HEAD/vignettes/sheet-geometry.Rmd" class="external-link"><code>vignettes/sheet-geometry.Rmd</code></a></small>
      <div class="d-none name"><code>sheet-geometry.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></code></pre></div>
<p><code><a href="../reference/read_excel.html">readxl::read_excel()</a></code> brings data from a rectangle of cells into R as a data frame or, more specifically, a <a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a>.</p>
<p>The extent of the data rectangle can be determined in various ways:</p>
<ul>
<li>
<strong>Discovered</strong>: By default, <code><a href="../reference/read_excel.html">read_excel()</a></code> uses the smallest rectangle that contains the non-empty cells. It “shrink wraps” the data.</li>
<li>
<strong>Bounded</strong>: The <code>skip</code> and <code>n_max</code> arguments constrain <code><a href="../reference/read_excel.html">read_excel()</a></code>’s discovery process with respect to rows. At least <code>skip</code> spreadsheet rows will be skipped or ignored and at most <code>n_max</code> spreadsheet rows will be considered as data. Compared to the default of <strong>discovery</strong>, these arguments can only lead to making the output tibble smaller.</li>
<li>
<strong>Set</strong>: The <code>range</code> argument is taken literally, even if that means you will have leading or trailing rows or columns filled with <code>NA</code>. If you ask for <code>range = "A1:D4"</code>, you are guaranteed to get a tibble with 4 columns (A through D) and either 3 rows (<code>col_names = TRUE</code>, default) or 4 rows (<code>col_names = FALSE</code>).</li>
<li>
<strong>Mixed</strong>: In typical use, <code><a href="../reference/read_excel.html">read_excel()</a></code>’s geometry arguments often imply that certain limits are <strong>discovered</strong> while others are <strong>bounded</strong> or <strong>set</strong>. This will be more clear in the concrete examples below.</li>
</ul>
<p>For now, here are a few ways <code><a href="../reference/read_excel.html">read_excel()</a></code> can look when you take control of the geometry:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"yo.xlsx"</span>, skip <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"yo.xlsx"</span>, n_max <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"yo.xlsx"</span>, skip <span class="op">=</span> <span class="fl">5</span>, n_max <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"yo.xlsx"</span>, range <span class="op">=</span> <span class="st">"C1:E7"</span><span class="op">)</span>
<span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"yo.xlsx"</span>, range <span class="op">=</span> <span class="fu"><a href="../reference/cell-specification.html">cell_rows</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">23</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"yo.xlsx"</span>, range <span class="op">=</span> <span class="fu"><a href="../reference/cell-specification.html">cell_cols</a></span><span class="op">(</span><span class="st">"B:D"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"yo.xlsx"</span>, range <span class="op">=</span> <span class="fu"><a href="../reference/cell-specification.html">anchored</a></span><span class="op">(</span><span class="st">"C4"</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="little-known-excel-facts">Little known Excel facts<a class="anchor" aria-label="anchor" href="#little-known-excel-facts"></a>
</h2>
<p>readxl’s behavior and interface may be easier to understand if you understand this about Excel:</p>
<blockquote>
<p>Cells you can see don’t necessarily exist. Cells that look blank aren’t necessarily so.</p>
</blockquote>
<p>Among lots of other information, Excel files obviously must contain information on each cell. Let’s use the word “item” to denote one cell’s-worth of info.</p>
<p>Just because you see a cell on the screen in Excel, that doesn’t mean there’s a corresponding item on file. Why? Because Excel presents a huge gridded canvas for you to write on. Until you actually populate a cell, though, it doesn’t really exist.</p>
<p>The stream of cell items describes the existing cells, going from upper left to lower right, travelling by row. Blank cells simply do not exist in it.</p>
<p>Ah, but what is a blank cell? Some cells appear blank to the naked eye but are not considered so by Excel and, indeed, are represented by a cell item. This happens when a cell has no content but does have an associated format. This format could have been applied directly to a single cell or, more often, indirectly via formatting applied to an entire row or column. Once a human has spent some quality time with a spreadsheet, many seemingly empty cells will bear a format and will thus have an associated cell item.</p>
<div class="section level3">
<h3 id="implications-for-readxl">Implications for readxl<a class="anchor" aria-label="anchor" href="#implications-for-readxl"></a>
</h3>
<p>readxl only reads cell items that have content. It ignores cell items that exist strictly to convey formatting.</p>
<p>The tibble returned by readxl will often cover cells that are empty in the spreadsheet, filled with <code>NA</code>. But only because there was some other reason for the associated row or column to exist: actual data or user-specified geometry.</p>
</div>
</div>
<div class="section level2">
<h2 id="skip-and-n_max">
<code>skip</code> and <code>n_max</code><a class="anchor" aria-label="anchor" href="#skip-and-n_max"></a>
</h2>
<p><code>skip</code> and <code>n_max</code> are the “entry-level” solution for controlling the data rectangle. They work only in the row direction. Column-wise, you’re letting readxl discover which columns are populated.</p>
<p>If you specify <code>range</code> (covered below), <code>skip</code> and <code>n_max</code> are ignored.</p>
<div class="section level3">
<h3 id="skip">
<code>skip</code><a class="anchor" aria-label="anchor" href="#skip"></a>
</h3>
<p>The <code>skip</code> argument tells <code><a href="../reference/read_excel.html">read_excel()</a></code> to start looking for populated cells after skipping at least <code>skip</code> rows. If the new start point begins with 1 or more empty rows, <code><a href="../reference/read_excel.html">read_excel()</a></code> will skip even more before it starts reading from the sheet.</p>
<p>Here’s a screen shot of the <code>geometry.xlsx</code> example sheet that ships with readxl, accessible via <code>readxl_example("geometry.xlsx")</code>.</p>
<p><img src="img/geometry.png" width="70%"></p>
<p>By default, <code><a href="../reference/read_excel.html">read_excel()</a></code> just discovers the data rectangle:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"geometry.xlsx"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span>
<span class="co">#&gt;   B3    C3    D3   </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> B4    C4    D4   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B5    C5    D5   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> B6    C6    D6</span></code></pre></div>
<p>If you explicitly skip one row, note that <code><a href="../reference/read_excel.html">read_excel()</a></code> still skips row 2, which is also empty, leading to the same result as before:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"geometry.xlsx"</span><span class="op">)</span>, skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span>
<span class="co">#&gt;   B3    C3    D3   </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> B4    C4    D4   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B5    C5    D5   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> B6    C6    D6</span></code></pre></div>
<p>You can also use <code>skip</code> to skip over populated cells. In real life, this is a mighty weapon against the explanatory text that people like to include at the top of spreadsheets.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"geometry.xlsx"</span><span class="op">)</span>, skip <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span>
<span class="co">#&gt;   B4    C4    D4   </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> B5    C5    D5   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B6    C6    D6</span></code></pre></div>
<p>Summary: <code>skip</code> tells <code><a href="../reference/read_excel.html">read_excel()</a></code> to skip <em>at least this many</em> spreadsheet rows before reading anything.</p>
</div>
<div class="section level3">
<h3 id="n_max">
<code>n_max</code><a class="anchor" aria-label="anchor" href="#n_max"></a>
</h3>
<p>The <code>n_max</code> argument tells <code><a href="../reference/read_excel.html">read_excel()</a></code> to read at most <code>n_max</code> rows, once it has found the data rectangle. Note that <code>n_max</code> is specifically about <em>the data</em>. You still use <code>col_names</code> to express whether the first spreadsheet row should be used to create column names (default is <code>TRUE</code>).</p>
<p><code>n_max = 2</code> causes us to ignore the last data row – the 3rd one – in <code>geometry.xlsx</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"geometry.xlsx"</span><span class="op">)</span>, n_max <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span>
<span class="co">#&gt;   B3    C3    D3   </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> B4    C4    D4   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B5    C5    D5</span></code></pre></div>
<p><code>n_max</code> is an upper bound. It will never cause empty rows to be included in the tibble. Note how we get 3 data rows here, even though <code>n_max</code> is much greater.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"geometry.xlsx"</span><span class="op">)</span>, n_max <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span>
<span class="co">#&gt;   B3    C3    D3   </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> B4    C4    D4   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B5    C5    D5   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> B6    C6    D6</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="range">
<code>range</code><a class="anchor" aria-label="anchor" href="#range"></a>
</h2>
<p>The <code>range</code> argument is the most flexible way to control geometry and is powered by the <a href="https://github.com/rsheets/cellranger#readme" class="external-link">cellranger</a> package.</p>
<p>One huge difference from <code>skip</code> and <code>n_max</code> is that <code>range</code> is taken literally! Even if it means the returned tibble will have entire rows or columns consisting of <code>NA</code>.</p>
<p>You can describe cell limits in a variety of ways:</p>
<p><strong>Excel-style range</strong>: Specify a fixed rectangle with <code>range = "A1:D4"</code> or <code>range = "R1C1:R4C4"</code>. You can even prepend the worksheet name like so: <code>range = "foofy!A1:D4"</code> and it will be passed along to the <code>sheet</code> argument.</p>
<p>The <code>deaths.xlsx</code> example sheet features junk rows both before and after the data rectangle. The payoff for specifying the data rectangle precisely is that we get the data frame we want, with correct guesses for the column types.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"deaths.xlsx"</span><span class="op">)</span>, range <span class="op">=</span> <span class="st">"arts!A5:F15"</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span>
<span class="co">#&gt;   Name          Profession   Age `Has kids` `Date of birth`    </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> David Bowie   musician      69 TRUE       1947-01-08 <span style="color: #949494;">00:00:00</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Carrie Fisher actor         60 TRUE       1956-10-21 <span style="color: #949494;">00:00:00</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Chuck Berry   musician      90 TRUE       1926-10-18 <span style="color: #949494;">00:00:00</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Bill Paxton   actor         61 TRUE       1955-05-17 <span style="color: #949494;">00:00:00</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 6 more rows, and 1 more variable: Date of death &lt;dttm&gt;</span></span></code></pre></div>
<p>We repeat the screenshot of <code>geometry.xlsx</code> as a visual reference.</p>
<p><img src="img/geometry.png" width="70%"></p>
<p>Going back to <code>geometry.xlsx</code>, here we specify a rectangle that only partially overlaps the data. Note the use of default column names, because the first row of cells is empty, and the leading column of <code>NA</code>s.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"geometry.xlsx"</span><span class="op">)</span>, range <span class="op">=</span> <span class="st">"A2:C4"</span><span class="op">)</span>
<span class="co">#&gt; New names:</span>
<span class="co">#&gt; * `` -&gt; ...1</span>
<span class="co">#&gt; * `` -&gt; ...2</span>
<span class="co">#&gt; * `` -&gt; ...3</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span>
<span class="co">#&gt;   ...1  ...2  ...3 </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>    B3    C3   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #BB0000;">NA</span>    B4    C4</span></code></pre></div>
<p><strong>Specific range of rows or columns</strong>: Set exact limits on just the rows or just the columns and allow the limits in the other direction to be discovered. Example calls:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## rows only</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(..., <span class="at">range =</span> <span class="fu">cell_rows</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="do">## is equivalent to</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(..., <span class="at">range =</span> <span class="fu">cell_rows</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="do">## columns only</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(..., <span class="at">range =</span> <span class="fu">cell_cols</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="do">## is equivalent to all of these</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(..., <span class="at">range =</span> <span class="fu">cell_cols</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">26</span>)))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(..., <span class="at">range =</span> <span class="fu">cell_cols</span>(<span class="st">"A:Z"</span>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(..., <span class="at">range =</span> <span class="fu">cell_cols</span>(LETTERS))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(..., <span class="at">range =</span> <span class="fu">cell_cols</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"Z"</span>))</span></code></pre></div>
<p>We use <code>geometry.xlsx</code> to demonstrate setting hard limits on the rows, running past the data, while allowing column limits to discovered. Note the trailing rows of <code>NA</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"geometry.xlsx"</span><span class="op">)</span>, range <span class="op">=</span> <span class="fu"><a href="../reference/cell-specification.html">cell_rows</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span>
<span class="co">#&gt;   B4    C4    D4   </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> B5    C5    D5   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B6    C6    D6   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></code></pre></div>
<p><strong>Anchored rectangle</strong>: Helper functions <code><a href="../reference/cell-specification.html">anchored()</a></code> and <code><a href="../reference/cell-specification.html">cell_limits()</a></code> let you specify limits via the corner(s) of the rectangle.</p>
<p>Here we get a 3 by 4 rectangle with cell C5 as the upper left corner:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"geometry.xlsx"</span><span class="op">)</span>,
  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"var"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,
  range <span class="op">=</span> <span class="fu"><a href="../reference/cell-specification.html">anchored</a></span><span class="op">(</span><span class="st">"C5"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span>
<span class="co">#&gt;   var_1 var_2 var_3 var_4</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> C5    D5    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C6    D6    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></code></pre></div>
<p>Here we set C5 as the upper left corner and allow the other limits to be discovered:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"geometry.xlsx"</span><span class="op">)</span>,
  col_names <span class="op">=</span> <span class="cn">FALSE</span>,
  range <span class="op">=</span> <span class="fu"><a href="../reference/cell-specification.html">cell_limits</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; New names:</span>
<span class="co">#&gt; * `` -&gt; ...1</span>
<span class="co">#&gt; * `` -&gt; ...2</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="co">#&gt;   ...1  ...2 </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> C5    D5   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C6    D6</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="http://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://jennybryan.org" class="external-link">Jennifer Bryan</a>, <a href="https://www.rstudio.com" class="external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" width="72"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

  </div></footer>
</body>
</html>
