<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cell and Column Types • readxl</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<!--optional theme--><link href="../.css" rel="stylesheet">
<meta property="og:title" content="Cell and Column Types">
<meta property="og:description" content="readxl">
<meta property="og:image" content="https://readxl.tidyverse.org/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">readxl</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of the <a href="https://tidyverse.org" class="external-link">tidyverse</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.1.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cell-and-column-types.html">Column Types</a>
    </li>
    <li>
      <a href="../articles/sheet-geometry.html">Sheet Geometry</a>
    </li>
    <li>
      <a href="../articles/articles/readxl-workflows.html">Workflows</a>
    </li>
    <li>
      <a href="../articles/articles/column-names.html">Column Names</a>
    </li>
    <li>
      <a href="../articles/articles/multiple-header-rows.html">Multiple Header Rows</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Blog posts</li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/12/readxl-1-2-0/" class="external-link">Version 1.2.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/04/readxl-1-1-0/" class="external-link">Version 1.1.0</a>
    </li>
    <li>
      <a href="../articles/releases/readxl-1.0.0.html">Version 1.0.0</a>
    </li>
    <li>
      <a href="../articles/releases/readxl-0.1.1.html">Version 0.1.1</a>
    </li>
    <li>
      <a href="../articles/releases/readxl-0.1.0.html">Version 0.1.0</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/readxl/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Cell and Column Types</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/readxl/blob/HEAD/vignettes/cell-and-column-types.Rmd" class="external-link"><code>vignettes/cell-and-column-types.Rmd</code></a></small>
      <div class="hidden name"><code>cell-and-column-types.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></code></pre></div>
<p><code><a href="../reference/read_excel.html">readxl::read_excel()</a></code> will guess column types, by default, or you can provide them explicitly via the <code>col_types</code> argument. The <code>col_types</code> argument is more flexible than you might think; you can mix actual types in with <code>"skip"</code> and <code>"guess"</code> and a single type will be recycled to the necessary length.</p>
<p>Here are different ways this might look:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"yo.xlsx"</span><span class="op">)</span>
<span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"yo.xlsx"</span>, col_types <span class="op">=</span> <span class="st">"numeric"</span><span class="op">)</span>
<span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"yo.xlsx"</span>, col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"skip"</span>, <span class="st">"guess"</span>, <span class="st">"numeric"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="type-guessing">Type guessing<a class="anchor" aria-label="anchor" href="#type-guessing"></a>
</h2>
<p>If you use other packages in the <a href="http://tidyverse.org" class="external-link">tidyverse</a>, you are probably familiar with <a href="http://readr.tidyverse.org" class="external-link">readr</a>, which reads data from flat files. Like readxl, readr also provides column type guessing, but readr and readxl are very different under the hood.</p>
<ul>
<li>readr guesses column type <em>based on the data</em>.</li>
<li>readxl guesses column type <em>based on Excel cell types</em>.</li>
</ul>
<p>Each cell in an Excel spreadsheet has its own type. For all intents and purposes, they are:</p>
<p>       empty &lt; boolean &lt; numeric &lt; text</p>
<p>with the wrinkle that datetimes are a very special flavor of numeric. A cell of any particular type can always be represented as one of any higher type and, possibly, as one of lower type. When guessing, <code><a href="../reference/read_excel.html">read_excel()</a></code> keeps a running “maximum” on the cell types it has seen in any given column. Once it has visited <code>guess_max</code> rows or run out of data, this is the guessed type for that column. There is a strong current towards “text”, the column type of last resort.</p>
<p>Here’s an example of column guessing with <code>deaths.xlsx</code> which ships with readxl.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"deaths.xlsx"</span><span class="op">)</span>, range <span class="op">=</span> <span class="fu"><a href="../reference/cell-specification.html">cell_rows</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span>
<span class="co">#&gt;   Name       Profession   Age `Has kids` `Date of birth`     `Date of death`    </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>             </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> David Bow… musician      69 TRUE       1947-01-08 <span style="color: #949494;">00:00:00</span> 2016-01-10 <span style="color: #949494;">00:00:00</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Carrie Fi… actor         60 TRUE       1956-10-21 <span style="color: #949494;">00:00:00</span> 2016-12-27 <span style="color: #949494;">00:00:00</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Chuck Ber… musician      90 TRUE       1926-10-18 <span style="color: #949494;">00:00:00</span> 2017-03-18 <span style="color: #949494;">00:00:00</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Bill Paxt… actor         61 TRUE       1955-05-17 <span style="color: #949494;">00:00:00</span> 2017-02-25 <span style="color: #949494;">00:00:00</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 6 more rows</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="excel-types-r-types-col_types">Excel types, R types, <code>col_types</code><a class="anchor" aria-label="anchor" href="#excel-types-r-types-col_types"></a>
</h2>
<p>Here’s how the Excel cell/column types are translated into R types and how to force the type explicitly in <code>col_types</code>:</p>
<table class="table">
<thead><tr class="header">
<th>How it is in Excel</th>
<th>How it will be in R</th>
<th>How to request in <code>col_types</code>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><em>anything</em></td>
<td><em>non-existent</em></td>
<td><code>"skip"</code></td>
</tr>
<tr class="even">
<td>empty</td>
<td>
<code>logical</code>, but all <code>NA</code>
</td>
<td><em>you cannot request this</em></td>
</tr>
<tr class="odd">
<td>boolean</td>
<td><code>logical</code></td>
<td><code>"logical"</code></td>
</tr>
<tr class="even">
<td>numeric</td>
<td><code>numeric</code></td>
<td><code>"numeric"</code></td>
</tr>
<tr class="odd">
<td>datetime</td>
<td><code>POSIXct</code></td>
<td><code>"date"</code></td>
</tr>
<tr class="even">
<td>text</td>
<td><code>character</code></td>
<td><code>"text"</code></td>
</tr>
<tr class="odd">
<td><em>anything</em></td>
<td><code>list</code></td>
<td><code>"list"</code></td>
</tr>
</tbody>
</table>
<p>Some explanation about the weird cases in the first two rows:</p>
<ul>
<li>If a column falls in your data rectangle, but you do not want an associated variable in the output, specify the column type <code>"skip"</code>. Internally, these cells may be visited in order to learn their location, but they are not loaded and their data is never read.</li>
<li>You cannot request that a column be included but filled with <code>NA</code>s. Such a column can arise naturally, if all the cells are empty, or you can skip a column (see previous point).</li>
</ul>
<p>Example of skipping and guessing:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"deaths.xlsx"</span><span class="op">)</span>,
  range <span class="op">=</span> <span class="fu"><a href="../reference/cell-specification.html">cell_rows</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>,
  col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"guess"</span>, <span class="st">"skip"</span>, <span class="st">"guess"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span>, <span class="st">"skip"</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 2</span></span>
<span class="co">#&gt;   Name            Age</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> David Bowie      69</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Carrie Fisher    60</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Chuck Berry      90</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Bill Paxton      61</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 6 more rows</span></span></code></pre></div>
<p>More about the <code>"list"</code> column type in the last row:</p>
<ul>
<li>This will create a list-column in the output, each component of which is a length one atomic vector. The type of these vectors is determined using the logic described above. This can be useful if data of truly disparate type is arranged in a column.</li>
</ul>
<p>We demonstrate the <code>"list"</code> column type using the <code>clippy.xlsx</code> sheet that ship with Excel. Its second column holds information about Clippy that would be really hard to store with just one type.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">clippy</span> <span class="op">&lt;-</span> 
   <span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"clippy.xlsx"</span><span class="op">)</span>, col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="st">"list"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span>
<span class="co">#&gt;   name                 value     </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Name                 <span style="color: #949494;">&lt;chr [1]&gt;</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Species              <span style="color: #949494;">&lt;chr [1]&gt;</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Approx date of death <span style="color: #949494;">&lt;dttm [1]&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Weight in grams      <span style="color: #949494;">&lt;dbl [1]&gt;</span></span>
<span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="va">clippy</span><span class="op">)</span>
<span class="co">#&gt; $Name</span>
<span class="co">#&gt; [1] "Clippy"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Species</span>
<span class="co">#&gt; [1] "paperclip"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`Approx date of death`</span>
<span class="co">#&gt; [1] "2007-01-01 UTC"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`Weight in grams`</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">clippy</span><span class="op">$</span><span class="va">value</span>, <span class="va">class</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] "character"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] "character"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] "POSIXct" "POSIXt" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] "numeric"</span></code></pre></div>
<p>Final note: all datetimes are imported as having the UTC timezone, because, mercifully, Excel has no notion of timezones.</p>
</div>
<div class="section level2">
<h2 id="when-column-guessing-goes-wrong">When column guessing goes wrong<a class="anchor" aria-label="anchor" href="#when-column-guessing-goes-wrong"></a>
</h2>
<p>It’s pretty common to expect a column to import as, say, numeric or datetime. And to then be sad when it imports as character instead. Two main causes:</p>
<p><strong>Contamination by embedded missing or bad data of incompatible type.</strong> Example: missing data entered as <code>??</code> in a numeric column.</p>
<ul>
<li>Fix: use the <code>na</code> argument of <code><a href="../reference/read_excel.html">read_excel()</a></code> to describe all possible forms for missing data. This should prevent such cells from influencing type guessing and cause them to import as <code>NA</code> of the appropriate type.</li>
</ul>
<p><strong>Contamination of the data rectangle by leading or trailing non-data rows.</strong> Example: the sheet contains a few lines of explanatory prose before the data table begins.</p>
<ul>
<li>Fix: specify the target rectangle. Use <code>skip</code> and <code>n_max</code> to provide a minimum number of rows to skip and a maximum number of data rows to read, respectively. Or use the more powerful <code>range</code> argument to describe the cell rectangle in various ways. See the examples for <code><a href="../reference/read_excel.html">read_excel()</a></code> help or <code><a href="../articles/sheet-geometry.html">vignette("sheet-geometry")</a></code> for more detail.</li>
</ul>
<p>The <code>deaths.xlsx</code> sheet demonstrates this perfectly. Here’s how it imports if we don’t specify <code>range</code> as we did above:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"deaths.xlsx"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; New names:</span>
<span class="co">#&gt; * `` -&gt; ...2</span>
<span class="co">#&gt; * `` -&gt; ...3</span>
<span class="co">#&gt; * `` -&gt; ...4</span>
<span class="co">#&gt; * `` -&gt; ...5</span>
<span class="co">#&gt; * `` -&gt; ...6</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">deaths</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 6</span></span>
<span class="co">#&gt;    `Lots of people`             ...2                     ...3  ...4  ...5  ...6 </span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> simply cannot resist writing <span style="color: #BB0000;">NA</span>                       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    some…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> at                           the                      top   <span style="color: #BB0000;">NA</span>    of    thei…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> or                           merging                  <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    cells</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Name                         Profession               Age   Has … Date… Date…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> David Bowie                  musician                 69    TRUE  17175 42379</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Carrie Fisher                actor                    60    TRUE  20749 42731</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Chuck Berry                  musician                 90    TRUE  9788  42812</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Bill Paxton                  actor                    61    TRUE  20226 42791</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Prince                       musician                 57    TRUE  21343 42481</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Alan Rickman                 actor                    69    FALSE 16854 42383</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Florence Henderson           actor                    82    TRUE  12464 42698</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Harper Lee                   author                   89    FALSE 9615  42419</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">13</span> Zsa Zsa Gábor                actor                    99    TRUE  6247  42722</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">14</span> George Michael               musician                 53    FALSE 23187 42729</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">15</span> Some                         <span style="color: #BB0000;">NA</span>                       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">16</span> <span style="color: #BB0000;">NA</span>                           also like to write stuff <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">17</span> <span style="color: #BB0000;">NA</span>                           <span style="color: #BB0000;">NA</span>                       at t… bott… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">18</span> <span style="color: #BB0000;">NA</span>                           <span style="color: #BB0000;">NA</span>                       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    too!</span></code></pre></div>
<p>Non-data rows above and below the main data rectangle are causing all the columns to import as character.</p>
<p>If your column typing problem can’t be solved by specifying <code>na</code> or the data rectangle, request the <code>"list"</code> column type and handle missing data and coercion after import.</p>
<div class="section level3">
<h3 id="peek-at-column-names">Peek at column names<a class="anchor" aria-label="anchor" href="#peek-at-column-names"></a>
</h3>
<p>Sometimes you aren’t completely sure of column count or order, and yet you need to provide <em>some</em> information via <code>col_types</code>. For example, you might know that the column named “foofy” should be text, but you’re not sure where it appears. Or maybe you want to ensure that lots of empty cells at the top of “foofy” don’t cause it to be guessed as logical.</p>
<p>Here’s an efficient trick to get the column names, so you can programmatically build the <code>col_types</code> vector you need for your main reading of the Excel file. Let’s imagine I want to force the columns whose names include “Petal” to be text, but leave everything else to be guessed.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">nms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"datasets.xlsx"</span><span class="op">)</span>, n_max <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"</span>
<span class="op">(</span><span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^Petal"</span>, <span class="va">nms</span><span class="op">)</span>, <span class="st">"text"</span>, <span class="st">"guess"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "guess" "guess" "text"  "text"  "guess"</span>
<span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"datasets.xlsx"</span><span class="op">)</span>, col_types <span class="op">=</span> <span class="va">ct</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 150 × 5</span></span>
<span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>          5.1         3.5 1.4          0.2         setosa </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>          4.9         3   1.4          0.2         setosa </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>          4.7         3.2 1.3          0.2         setosa </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>          4.6         3.1 1.5          0.2         setosa </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 146 more rows</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="square-pegs-in-round-holes">Square pegs in round holes<a class="anchor" aria-label="anchor" href="#square-pegs-in-round-holes"></a>
</h2>
<p>You can force a column to have a specific type via <code>col_types</code>. So what happens to cells of another type? They will either be coerced to the requested type or to an <code>NA</code> of appropriate type.</p>
<p>For each column type, below we present a screen shot of a sheet from the built-in example <code>type-me.xlsx</code>. We force the first column to have a specific type and the second column explains what is in the first. You’ll see how mismatches between cell type and column type are resolved.</p>
<div class="section level3">
<h3 id="logical-column">Logical column<a class="anchor" aria-label="anchor" href="#logical-column"></a>
</h3>
<p>A numeric cell is coerced to <code>FALSE</code> if it is zero and <code>TRUE</code> otherwise. A date cell becomes <code>NA</code>. Just like in R, the strings “T”, “TRUE”, “True”, and “true” are regarded as <code>TRUE</code> and “F”, “FALSE”, “False”, “false” as <code>FALSE</code>. Other strings import as <code>NA</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"type-me.xlsx"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="st">"logical_coercion"</span>,
                 col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logical"</span>, <span class="st">"text"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Expecting logical in A5 / R5C1: got a date</span>
<span class="co">#&gt; Warning: Expecting logical in A8 / R8C1: got 'cabbage'</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 2</span></span>
<span class="co">#&gt;    `maybe boolean?` description                         </span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                               </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #BB0000;">NA</span>               <span style="color: #949494;">"</span>empty<span style="color: #949494;">"</span>                             </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> FALSE            <span style="color: #949494;">"</span>0 (numeric)<span style="color: #949494;">"</span>                       </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> TRUE             <span style="color: #949494;">"</span>1 (numeric)<span style="color: #949494;">"</span>                       </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #BB0000;">NA</span>               <span style="color: #949494;">"</span>datetime<span style="color: #949494;">"</span>                          </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> TRUE             <span style="color: #949494;">"</span>boolean true<span style="color: #949494;">"</span>                      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> FALSE            <span style="color: #949494;">"</span>boolean false<span style="color: #949494;">"</span>                     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #BB0000;">NA</span>               <span style="color: #949494;">"</span>\"cabbage\"<span style="color: #949494;">"</span>                       </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> TRUE             <span style="color: #949494;">"</span>the string \"true\"<span style="color: #949494;">"</span>               </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> FALSE            <span style="color: #949494;">"</span>the letter \"F\"<span style="color: #949494;">"</span>                  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> FALSE            <span style="color: #949494;">"</span>\"False\" preceded by single quote<span style="color: #949494;">"</span></span></code></pre></div>
<p><img src="img/type-me-logical.png" width="70%"></p>
</div>
<div class="section level3">
<h3 id="numeric-column">Numeric column<a class="anchor" aria-label="anchor" href="#numeric-column"></a>
</h3>
<p>A boolean cell is coerced to zero if <code>FALSE</code> and one if <code>TRUE</code>. A datetime comes in as the underlying serial date, which is the number of days, possibly fractional, since the <a href="https://support.microsoft.com/en-us/help/214330/differences-between-the-1900-and-the-1904-date-system-in-excel" class="external-link">date origin</a>. For text, numeric conversion is attempted, to handle the “number as text” phenomenon. If unsuccessful, text cells import as <code>NA</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"type-me.xlsx"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="st">"numeric_coercion"</span>,
                 col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"numeric"</span>, <span class="st">"text"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Coercing boolean to numeric in A3 / R3C1</span>
<span class="co">#&gt; Warning: Coercing boolean to numeric in A4 / R4C1</span>
<span class="co">#&gt; Warning: Expecting numeric in A5 / R5C1: got a date</span>
<span class="co">#&gt; Warning: Coercing text to numeric in A6 / R6C1: '123456'</span>
<span class="co">#&gt; Warning: Expecting numeric in A8 / R8C1: got 'cabbage'</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 2</span></span>
<span class="co">#&gt;   `maybe numeric?` explanation            </span>
<span class="co">#&gt;              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>               <span style="color: #BB0000;">NA</span> <span style="color: #949494;">"</span>empty<span style="color: #949494;">"</span>                </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                1 <span style="color: #949494;">"</span>boolean true<span style="color: #949494;">"</span>         </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>                0 <span style="color: #949494;">"</span>boolean false<span style="color: #949494;">"</span>        </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>            <span style="text-decoration: underline;">40</span>534 <span style="color: #949494;">"</span>datetime<span style="color: #949494;">"</span>             </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>           <span style="text-decoration: underline;">123</span>456 <span style="color: #949494;">"</span>the string \"123456\"<span style="color: #949494;">"</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>           <span style="text-decoration: underline;">123</span>456 <span style="color: #949494;">"</span>the number 123456<span style="color: #949494;">"</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span>               <span style="color: #BB0000;">NA</span> <span style="color: #949494;">"</span>\"cabbage\"<span style="color: #949494;">"</span></span></code></pre></div>
<p><img src="img/type-me-numeric.png" width="70%"></p>
</div>
<div class="section level3">
<h3 id="date-column">Date column<a class="anchor" aria-label="anchor" href="#date-column"></a>
</h3>
<p>A numeric cell is interpreted as a serial date (<em>I’m questioning whether this is wise, but <a href="https://github.com/tidyverse/readxl/issues/266" class="external-link uri">https://github.com/tidyverse/readxl/issues/266</a></em>). Boolean or text cells become <code>NA</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"type-me.xlsx"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="st">"date_coercion"</span>,
                 col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"text"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Expecting date in A5 / R5C1: got boolean</span>
<span class="co">#&gt; Warning: Expecting date in A6 / R6C1: got 'cabbage'</span>
<span class="co">#&gt; Warning: Coercing numeric to date A7 / R7C1</span>
<span class="co">#&gt; Warning: Coercing numeric to date A8 / R8C1</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 2</span></span>
<span class="co">#&gt;   `maybe a datetime?` explanation           </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>                  <span style="color: #949494;">"</span>empty<span style="color: #949494;">"</span>               </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2016-05-23 <span style="color: #949494;">00:00:00</span> <span style="color: #949494;">"</span>date only format<span style="color: #949494;">"</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2016-04-28 <span style="color: #949494;">11:30:00</span> <span style="color: #949494;">"</span>date and time format<span style="color: #949494;">"</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">NA</span>                  <span style="color: #949494;">"</span>boolean true<span style="color: #949494;">"</span>        </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="color: #BB0000;">NA</span>                  <span style="color: #949494;">"</span>\"cabbage\"<span style="color: #949494;">"</span>         </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1904-01-05 <span style="color: #949494;">07:12:00</span> <span style="color: #949494;">"</span>4.3 (numeric)<span style="color: #949494;">"</span>       </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 2012-01-02 <span style="color: #949494;">00:00:00</span> <span style="color: #949494;">"</span>another numeric<span style="color: #949494;">"</span></span></code></pre></div>
<p><img src="img/type-me-date.png" width="70%"></p>
</div>
<div class="section level3">
<h3 id="text-or-character-column">Text or character column<a class="anchor" aria-label="anchor" href="#text-or-character-column"></a>
</h3>
<p>A boolean cell becomes either <code>"TRUE"</code> or <code>"FALSE"</code>. A numeric cell is converted to character, much like <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code> in R. A date cell is handled like numeric, using the underlying serial value.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="../reference/readxl_example.html">readxl_example</a></span><span class="op">(</span><span class="st">"type-me.xlsx"</span><span class="op">)</span>, sheet <span class="op">=</span> <span class="st">"text_coercion"</span>,
                 col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="st">"text"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span>
<span class="co">#&gt;   text     explanation      </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>       <span style="color: #949494;">"</span>empty<span style="color: #949494;">"</span>          </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> cabbage  <span style="color: #949494;">"</span>\"cabbage\"<span style="color: #949494;">"</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> TRUE     <span style="color: #949494;">"</span>boolean true<span style="color: #949494;">"</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1.3      <span style="color: #949494;">"</span>numeric<span style="color: #949494;">"</span>        </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 41175    <span style="color: #949494;">"</span>datetime<span style="color: #949494;">"</span>       </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 36436153 <span style="color: #949494;">"</span>another numeric<span style="color: #949494;">"</span></span></code></pre></div>
<p><img src="img/type-me-text.png" width="70%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="tidyverse">
  <p>readxl is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org" class="external-link">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by .
    Site built by <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
